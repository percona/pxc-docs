



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-xtradb-cluster-docs/8.0/8.0/howtos/upgrade_guide.html">
      
      
        <link rel="prev" href="../management/data_at_rest_encryption.html">
      
      
        <link rel="next" href="crash-recovery.html">
      
      <link rel="icon" href="../_static/percona-favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>Upgrade Percona XtraDB Cluster - Percona XtraDB Cluster</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="../css/percona.css">
    
      <link rel="stylesheet" href="../css/nocopy.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-343802-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
              

              <script>
              (function (w, d, s, l, i) {
                  w[l] = w[l] || []; w[l].push({
                    'gtm.start': new Date().getTime(), 
                    event: 'gtm.js'
                  });
                  var f = d.getElementsByTagName(s)[0],
                  j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
                  j.async = true; 
                  j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
                  f.parentNode.insertBefore(j, f);
                })(window, document, 'script', 'dataLayer', 'GTM-K48FGP2');
              </script>
              
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrade-percona-xtradb-cluster" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docs.percona.com" title="Percona XtraDB Cluster" class="md-header__button md-logo" aria-label="Percona XtraDB Cluster" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Percona XtraDB Cluster
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrade Percona XtraDB Cluster
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/percona/pxc-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxc-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.percona.com" title="Percona XtraDB Cluster" class="md-nav__button md-logo" aria-label="Percona XtraDB Cluster" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    Percona XtraDB Cluster
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/pxc-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro.html" class="md-nav__link">
        About Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../limitation.html" class="md-nav__link">
        Percona XtraDB Cluster limitations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtradb-cluster-version-numbers.html" class="md-nav__link">
        Understand version numbers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Get started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Get started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        Quick start guide for Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install/index.html" class="md-nav__link">
        Install Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configure.html" class="md-nav__link">
        Configure nodes for write-set replication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bootstrap.html" class="md-nav__link">
        Bootstrap the first node
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add-node.html" class="md-nav__link">
        Add nodes to cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../verify.html" class="md-nav__link">
        Verify replication
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/highavailability.html" class="md-nav__link">
        High availability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/pxc-strict-mode.html" class="md-nav__link">
        PXC strict mode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/online-schema-upgrade.html" class="md-nav__link">
        Online schema upgrade
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/nbo.html" class="md-nav__link">
        Non-Blocking Operations (NBO) method for Online Scheme Upgrades (OSU)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          PXC security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          PXC security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/index.html" class="md-nav__link">
        Security basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/secure-network.html" class="md-nav__link">
        Secure the network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/encrypt-traffic.html" class="md-nav__link">
        Encrypt PXC traffic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/apparmor.html" class="md-nav__link">
        Enable AppArmor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/selinux.html" class="md-nav__link">
        Enable SELinux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          User's manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          User's manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/state_snapshot_transfer.html" class="md-nav__link">
        State snapshot transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/xtrabackup_sst.html" class="md-nav__link">
        Percona XtraBackup SST configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/restarting_nodes.html" class="md-nav__link">
        Restart the cluster nodes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/failover.html" class="md-nav__link">
        Cluster failover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/monitoring.html" class="md-nav__link">
        Monitor the cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/certification.html" class="md-nav__link">
        Certification in Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/threading_model.html" class="md-nav__link">
        Percona XtraDB Cluster threading model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/gcache_record-set_cache_difference.html" class="md-nav__link">
        Understand GCache and Record-Set cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../management/gcache-write-set-cache-encryption.html" class="md-nav__link">
        GCache encryption and Write-Set cache encryption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/performance_schema_instrumentation.html" class="md-nav__link">
        Perfomance Schema instrumentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../management/data_at_rest_encryption.html" class="md-nav__link">
        Data at Rest Encryption
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          How-tos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          How-tos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Upgrade Percona XtraDB Cluster
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="upgrade_guide.html" class="md-nav__link md-nav__link--active">
        Upgrade Percona XtraDB Cluster
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-changes-in-percona-xtradb-cluster-80" class="md-nav__link">
    Important changes in Percona XtraDB Cluster 8.0
  </a>
  
    <nav class="md-nav" aria-label="Important changes in Percona XtraDB Cluster 8.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traffic-encryption-is-enabled-by-default" class="md-nav__link">
    Traffic encryption is enabled by default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-recommended-to-mix-pxc-57-nodes-with-pxc-80-nodes" class="md-nav__link">
    Not recommended to mix PXC 5.7 nodes with PXC 8.0 nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pxc-strict-mode-is-enabled-by-default" class="md-nav__link">
    [PXC strict mode] is enabled by default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-configuration-file-layout-has-changed-in-pxc-80" class="md-nav__link">
    The configuration file layout has changed in PXC 8.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caching_sha2_password-is-the-default-authentication-plugin" class="md-nav__link">
    caching_sha2_password is the default authentication plugin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql_upgrade-is-part-of-sst" class="md-nav__link">
    mysql_upgrade is part of SST
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#major-upgrade-scenarios" class="md-nav__link">
    Major upgrade scenarios
  </a>
  
    <nav class="md-nav" aria-label="Major upgrade scenarios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-no-active-parallel-workload-or-with-read-only-workload" class="md-nav__link">
    Scenario: No active parallel workload or with read-only workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-upgrade-from-pxc-56-to-pxc-80" class="md-nav__link">
    Scenario: Upgrade from PXC 5.6 to PXC 8.0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minor-upgrade" class="md-nav__link">
    Minor upgrade
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="crash-recovery.html" class="md-nav__link">
        Crash recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="centos_howto.html" class="md-nav__link">
        Configure Percona XtraDB Cluster on CentOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ubuntu_howto.html" class="md-nav__link">
        Configure Percona XtraDB Cluster on Ubuntu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="garbd_howto.html" class="md-nav__link">
        Set up Galera arbitrator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="singlebox.html" class="md-nav__link">
        How to set up a three-node cluster on a single box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="3nodesec2.html" class="md-nav__link">
        How to set up a three-node cluster in EC2 environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="haproxy.html" class="md-nav__link">
        Load balancing with HAProxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="proxysql.html" class="md-nav__link">
        Load balancing with ProxySQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="proxysql-v2.html" class="md-nav__link">
        ProxySQL admin utilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="virt_sandbox.html" class="md-nav__link">
        Setting up a testing environment with ProxySQL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Release notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Release notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/release-notes_index.html" class="md-nav__link">
        Release notes index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0.31-23.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.31-23 (2023-03-14)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0.30-22.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.30-22.md (2022-12-28)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0.29-21.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.29-21 (2022-09-12)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.28-19.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.28-19.1 (2022-07-19)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.27-18.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.27-18.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.26-16.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.26-16.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.25-15.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.25-15.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.23-14.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.23-14.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.22-13.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.22-13.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.21-12.1.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.21-12.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.20-11.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.20-11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.20-11.3.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.20-11.3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.20-11.2.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.20-11.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.19-10.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.19-10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-8.0.18-9.3.html" class="md-nav__link">
        Percona XtraDB Cluster 8.0.18-9.3
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-status-index.html" class="md-nav__link">
        Index of wsrep status variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-system-index.html" class="md-nav__link">
        Index of wsrep system variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-provider-index.html" class="md-nav__link">
        Index of wsrep_provider options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-files-index.html" class="md-nav__link">
        Index of files created by PXC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq.html" class="md-nav__link">
        Frequently asked questions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyright-and-licensing-information.html" class="md-nav__link">
        Copyright and licensing information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trademark-policy.html" class="md-nav__link">
        Trademark policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
    <br/>
   <label class="md-nav__title" for="__drawer">
    <a href="https://learn.percona.com/download-percona-xtradb-cluster-8-manual" onclick="_gaq.push(['b._trackEvent', 'Percona XtraBackup', 'Download', 'Download Manual Percona XtraBackup']);" class="md-nav__link md-nav__link--active">
      Download PDF
    </a>
  </label> 
  </ul>
</nav>

                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-changes-in-percona-xtradb-cluster-80" class="md-nav__link">
    Important changes in Percona XtraDB Cluster 8.0
  </a>
  
    <nav class="md-nav" aria-label="Important changes in Percona XtraDB Cluster 8.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traffic-encryption-is-enabled-by-default" class="md-nav__link">
    Traffic encryption is enabled by default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#not-recommended-to-mix-pxc-57-nodes-with-pxc-80-nodes" class="md-nav__link">
    Not recommended to mix PXC 5.7 nodes with PXC 8.0 nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pxc-strict-mode-is-enabled-by-default" class="md-nav__link">
    [PXC strict mode] is enabled by default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-configuration-file-layout-has-changed-in-pxc-80" class="md-nav__link">
    The configuration file layout has changed in PXC 8.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caching_sha2_password-is-the-default-authentication-plugin" class="md-nav__link">
    caching_sha2_password is the default authentication plugin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql_upgrade-is-part-of-sst" class="md-nav__link">
    mysql_upgrade is part of SST
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#major-upgrade-scenarios" class="md-nav__link">
    Major upgrade scenarios
  </a>
  
    <nav class="md-nav" aria-label="Major upgrade scenarios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-no-active-parallel-workload-or-with-read-only-workload" class="md-nav__link">
    Scenario: No active parallel workload or with read-only workload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-upgrade-from-pxc-56-to-pxc-80" class="md-nav__link">
    Scenario: Upgrade from PXC 5.6 to PXC 8.0
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minor-upgrade" class="md-nav__link">
    Minor upgrade
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                <!-- Edit and view button -->
                
                  
                  
                  <a
                    href="https://github.com/percona/pxc-docs/edit/8.0/docs/howtos/upgrade_guide.md"
                    title=""
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
                  </a>
                  <a
                    href="https://raw.githubusercontent.com/percona/pxc-docs/8.0/docs/howtos/upgrade_guide.md"
                    title="View source of this page"
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
                  </a>
                

                <!--
                  Hack: check whether the content contains a h1 headline. If it
                  doesn't, the page title (or respectively site name) is used
                  as the main headline.
                -->
                

                <!-- Markdown content -->
                <h1 id="upgrade-percona-xtradb-cluster">Upgrade Percona XtraDB Cluster<a class="headerlink" href="#upgrade-percona-xtradb-cluster" title="Permanent link">&para;</a></h1>
<!-- This guide describes the procedure for upgrading Percona XtraDB Cluster without downtime
(*rolling upgrade*) to the Percona XtraDB Cluster 8.0. -->
<!-- A "rolling upgrade" means there is no need to take down the complete
cluster during the upgrade. -->
<p>The following documents contain details about relevant changes in the 8.0 series
of MySQL and Percona Server for MySQL. Make sure you deal with any incompatible features
and variables mentioned in these documents when upgrading to Percona XtraDB Cluster 8.0.</p>
<ul>
<li>
<p><a href="https://www.percona.com/doc/percona-server/8.0/changed_in_version.html">Changed in Percona Server for MySQL 8.0</a></p>
</li>
<li>
<p><a href="http://dev.mysql.com/doc/refman/8.0/en/upgrading.html">Upgrading MySQL</a></p>
</li>
<li>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/upgrading-from-previous-series.html">Upgrading from MySQL 5.7 to 8.0</a></p>
</li>
</ul>
<h2 id="important-changes-in-percona-xtradb-cluster-80">Important changes in Percona XtraDB Cluster 8.0<a class="headerlink" href="#important-changes-in-percona-xtradb-cluster-80" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#upgrade-percona-xtradb-cluster">Upgrade Percona XtraDB Cluster</a></li>
<li><a href="#important-changes-in-percona-xtradb-cluster-80">Important changes in Percona XtraDB Cluster 8.0</a><ul>
<li><a href="#traffic-encryption-is-enabled-by-default">Traffic encryption is enabled by default</a></li>
<li><a href="#not-recommended-to-mix-pxc-57-nodes-with-pxc-80-nodes">Not recommended to mix PXC 5.7 nodes with PXC 8.0 nodes</a></li>
<li><a href="#pxc-strict-mode-is-enabled-by-default">[PXC strict mode] is enabled by default</a></li>
<li><a href="#the-configuration-file-layout-has-changed-in-pxc-80">The configuration file layout has changed in PXC 8.0</a></li>
<li><a href="#caching_sha2_password-is-the-default-authentication-plugin">caching_sha2_password is the default authentication plugin</a></li>
<li><a href="#mysql_upgrade-is-part-of-sst">mysql_upgrade is part of SST</a></li>
</ul>
</li>
<li><a href="#major-upgrade-scenarios">Major upgrade scenarios</a><ul>
<li><a href="#scenario-no-active-parallel-workload-or-with-read-only-workload">Scenario: No active parallel workload or with read-only workload</a></li>
<li><a href="#scenario-upgrade-from-pxc-56-to-pxc-80">Scenario: Upgrade from PXC 5.6 to PXC 8.0</a></li>
</ul>
</li>
<li><a href="#minor-upgrade">Minor upgrade</a></li>
</ul>
<h3 id="traffic-encryption-is-enabled-by-default">Traffic encryption is enabled by default<a class="headerlink" href="#traffic-encryption-is-enabled-by-default" title="Permanent link">&para;</a></h3>
<p>The <code>pxc_encrypt_cluster_traffic</code> variable, which enables traffic
encryption, is set to <code>ON</code> by default in Percona XtraDB Cluster 8.0.</p>
<p>Unless you configure a node accordingly (each node in your cluster must use the
same SSL certificates) or try to join a cluster running PXC 5.7 which
unencrypted cluster traffic, the node will not be able to join resulting in an
error.</p>
<details class="example">
<summary>The error message</summary>
<div class="no-copy highlight"><pre><span></span><code>... [ERROR] ... [Galera] handshake with remote endpoint ...
This error is often caused by SSL issues. ...
</code></pre></div>
</details>
<div class="admonition admonition">
<p class="admonition-title">See also</p>
<p>sections <a href="../security/encrypt-traffic.html#encrypt-traffic">Encrypting PXC Traffic</a>, <a href="../configure.html#configure">Configuring Nodes for Write-Set Replication</a></p>
</div>
<!-- Rolling upgrades to |version| from versions older than 5.7 are not supported
--------------------------------------------------------------------------------

Therefore, if you are running Percona XtraDB Cluster version 5.6, shut down all
nodes, then remove and re-create the cluster from scratch. Alternatively,
you can perform a `rolling upgrade from PXC 5.6 to 5.7 <https://www.percona.com/doc/percona-xtradb-cluster/5.7/howtos/upgrade_guide.html>`_.
and then follow the current procedure to upgrade from 5.7 to 8.0. -->
<h3 id="not-recommended-to-mix-pxc-57-nodes-with-pxc-80-nodes">Not recommended to mix PXC 5.7 nodes with PXC 8.0 nodes<a class="headerlink" href="#not-recommended-to-mix-pxc-57-nodes-with-pxc-80-nodes" title="Permanent link">&para;</a></h3>
<p>Shut down the cluster and upgrade each node to PXC 8.0. It is
important that you make backups before attempting an upgrade.</p>
<!-- If downtime is acceptable
Shut down the cluster and upgrade all nodes to PXC
8.0. It is important that you make backups before attempting an upgrade. -->
<!-- If downtime is not possible
The rolling upgrade is supported but ensure the
traffic is controlled during the upgrade and writes are directed only to 5.7
nodes until all nodes are upgraded to 8.0. -->
<h3 id="pxc-strict-mode-is-enabled-by-default">[PXC strict mode] is enabled by default<a class="headerlink" href="#pxc-strict-mode-is-enabled-by-default" title="Permanent link">&para;</a></h3>
<p>Percona XtraDB Cluster in 8.0 runs with <a href="../features/pxc-strict-mode.html#pxc-strict-mode">PXC Strict Mode</a> enabled by default. This will deny any unsupported operations and may halt the server if <a href="../features/pxc-strict-mode.html#validations">a strict mode validation fails</a>. It is recommended to first start the node with
the <code>pxc_strict_mode</code> variable set to <code>PERMISSIVE</code> in the MySQL
configuration file (on Debian and Ubuntu <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>; on CentOS and Red Hat /etc/my.cnf).</p>
<p>After you check the log for any tech preview features or unsupported features
and you have fixed any of the encountered incompatibilities, set the variable
back to <code>ENFORCING</code> at run time:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SET<span class="w"> </span><span class="nv">pxc_strict_mode</span><span class="o">=</span>ENFORCING<span class="p">;</span>
</code></pre></div>
<p>Also, switching back to <code>ENFORCING</code> may be done by restarting the node with
the updated configuration file (on Debian and Ubuntu <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>; on CentOS and Red Hat /etc/my.cnf).</p>
<h3 id="the-configuration-file-layout-has-changed-in-pxc-80">The configuration file layout has changed in PXC 8.0<a class="headerlink" href="#the-configuration-file-layout-has-changed-in-pxc-80" title="Permanent link">&para;</a></h3>
<p>All configuration settings are stored in the default MySQL configuration file:</p>
<ul>
<li>
<p>Path on Debian and Ubuntu: <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code></p>
</li>
<li>
<p>Path on Red Hat and CentOS: /etc/my.cnf</p>
</li>
</ul>
<p>Before you start the upgrade, move your custom settings from
<code>/etc/mysql/percona-xtradb-cluster.conf.d/wsrep.cnf</code> (on Debian and
Ubuntu) or from <code>/etc/percona-xtradb-cluster.conf.d/wsrep.cnf</code> (on Red Hat
and CentOS) to the new location accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have moved your my.cnf file to a different location and added a symlink to <code>/etc/my.cnf</code>, the RPM package manager, when upgrading, can delete the symlink and put a default my.cnf file in /etc/.</p>
</div>
<h3 id="caching_sha2_password-is-the-default-authentication-plugin">caching_sha2_password is the default authentication plugin<a class="headerlink" href="#caching_sha2_password-is-the-default-authentication-plugin" title="Permanent link">&para;</a></h3>
<p>In Percona XtraDB Cluster 8.0, the default authentication plugin is
<code>caching_sha2_password</code>. The ProxySQL option
<a href="proxysql-v2.html#pxc-proxysql-v2-admin-tool-syncusers">â€“syncusers</a> will not work if the Percona XtraDB Cluster user is
created using <code>caching_sha2_password</code>. Use the <code>mysql_native_password</code>
authentication plugin in these cases.</p>
<p>Be sure you are running on the latest 5.7 version before you upgrade to 8.0.</p>
<h3 id="mysql_upgrade-is-part-of-sst">mysql_upgrade is part of <a href="../glossary.html#sst">SST</a><a class="headerlink" href="#mysql_upgrade-is-part-of-sst" title="Permanent link">&para;</a></h3>
<p><strong>mysql_upgrade</strong> is now run automatically as part of <a href="../glossary.html#sst">SST</a>. You do not have
to run it manually when upgrading your system from an older version.</p>
<!-- Rolling Upgrade of a 3-Node PXC from 5.7 to 8.0
================================================================================

The major upgrade involves upgrading the PXC from the previous major version
5.7 to the new major version 8.0.

To upgrade the cluster, follow these steps for each node:

#. Make sure that all nodes are synchronized.

#. Stop the ``mysql`` service: -->
<!-- .. code-block: bash

$ sudo service mysql stop -->
<!-- #. Remove existing Percona XtraDB Cluster and Percona XtraBackup packages, then install Percona XtraDB Cluster version 8.0 packages.  For more information, see :ref:`install`.

For example, if you have Percona software repositories configured,
you might use the following commands: -->
<!-- * On CentOS or RHEL:

.. code-block: bash

   $ sudo yum remove percona-xtrabackup* Percona-XtraDB-Cluster*
   $ sudo yum install percona-xtradb-cluster -->
<!-- * On Debian or Ubuntu:

.. code-block: bash

   $ sudo apt-get remove percona-xtrabackup* percona-xtradb-cluster*
   $ sudo apt-get install percona-xtradb-cluster -->
<!-- #. Back up :file:`grastate.dat`, so that you can restore it
if it is corrupted or zeroed out due to network issue. -->
<!-- #. Now, start the cluster node with 8.0 packages installed, PXC will upgrade
the data directory as needed - either as part of the startup process or a
state transfer (IST/SST).

In most cases, starting the ``mysql`` service should run the node with your
previous configuration. For more information, see :ref:`add-node`.

.. code-block: bash

   $ sudo service mysql start

.. note:

   On CentOS, the `/etc/my.cnf` configuration file is renamed to
   `my.cnf.rpmsave`.  Make sure to rename it back before
   joining the upgraded node back to the cluster.

|strict-mode| is enabled by default, which may result in denying any unsupported operations and may halt the server. For more information, see    :ref:`upgrade-guide-changed-strict-mode`.

|opt.encrypt-cluster-traffic| is enabled by default. You need to configure
each node accordingly and avoid joining a cluster with unencrypted cluster
traffic: all nodes in your cluster must have traffic encryption enabled. For
more information, see :ref:`upgrade-guide-changed-traffic-encryption`. -->
<!-- #. Repeat this procedure for the next node in the cluster until you upgrade all nodes. -->
<h2 id="major-upgrade-scenarios">Major upgrade scenarios<a class="headerlink" href="#major-upgrade-scenarios" title="Permanent link">&para;</a></h2>
<p>Upgrading PXC from 5.7 to 8.0 may have slightly different strategies depending
on the configuration and workload on your PXC cluster.</p>
<p>Note that the new default value of <code>pxc-encrypt-cluster-traffic</code> (set to <em>ON</em>
versus <em>OFF</em> in PXC 5.7) requires additional care. You cannot join a 5.7 node
to a PXC 8.0 cluster unless the node has traffic encryption enabled as the
cluster may not have some nodes with traffic encryption enabled and some nodes
with traffic encryption disabled. For more information, see
<a href="#traffic-encryption-is-enabled-by-default">Traffic encryption is enabled by default</a>.</p>
<h3 id="scenario-no-active-parallel-workload-or-with-read-only-workload">Scenario: No active parallel workload or with read-only workload<a class="headerlink" href="#scenario-no-active-parallel-workload-or-with-read-only-workload" title="Permanent link">&para;</a></h3>
<p>If there is no active parallel workload or the cluster has read-only workload
while upgrading the nodes, complete the following procedure for each node in the
cluster:</p>
<ol>
<li>
<p>Shutdown one of the node 5.7 cluster nodes.</p>
</li>
<li>
<p>Remove 5.7 PXC packages without removing the data-directory.</p>
</li>
<li>
<p>Install PXC 8.0 packages.</p>
</li>
<li>
<p>Restart the mysqld service.</p>
</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before upgrading, make sure your application can work with a reduced cluster
size.  Also, during the upgrade, the cluster will operate with an even number
of nodes - the cluster may run into the split-brain problem.</p>
</div>
<p>This upgrade flow auto-detects the presence of the 5.7 data directory and trigger
the upgrade as part of the node bootup process. The data directory is upgraded
to be compatible with PXC 8.0. Then the node joins the cluster and
enters synced state. The 3-node cluster is restored with 2 nodes running PXC
5.7 and 1 node running PXC 8.0.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since <a href="../glossary.html#sst">SST</a> is not involved, <a href="../glossary.html#sst">SST</a> based auto-upgrade flow is not started.</p>
</div>
<p>PXC 8.0 uses Galera 4 while PXC 5.7 uses Galera-3. The cluster will
continue to use the protocol version 3 used in Galera 3 effectively limiting
some of the functionality. With all nodes upgraded to version 8.0,
protocol version 4 is applied.</p>
<div class="admonition admonition">
<p class="admonition-title">Tip</p>
<p>The protocol version is stored in the <code>protocol_version</code> column of the <code>wsrep_cluster</code> table.</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>USE<span class="w"> </span>mysql<span class="p">;</span>
</code></pre></div>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SELECT<span class="w"> </span>protocol_version<span class="w"> </span>from<span class="w"> </span>wsrep_cluster<span class="p">;</span>
</code></pre></div>
<p>The example of the output is the following:</p>
<div class="no-copy highlight"><pre><span></span><code>+------------------+
| protocol_version |
+------------------+
|                4 |
+------------------+
1 row in set (0.00 sec)
</code></pre></div>
</div>
<p>As soon as the last 5.7 node shuts down, the configuration of the remaining
two nodes is updated to use protocol version 4. A new upgraded node will then join
using protocol version 4 and the whole cluster will maintain
protocol version 4 enabling the support for additional Galera 4 facilities.</p>
<p>It may take longer to join the last upgraded node since it will invite
<a href="../glossary.html#ist">IST</a> to obtain the configuration changes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting from Galera 4, the configuration changes are cached to <code>gcache</code>
and the configuration changes are donated as part of <a href="../glossary.html#ist">IST</a> or
<a href="../glossary.html#sst">SST</a> to help build the certification queue on the JOINING node. As
other nodes (say n2 and n3), already using protocol version 4, donate the
configuration changes when the JOINER node is booted.</p>
</div>
<p>The situation was different for the previous and penultimate nodes since the
donation of the configuration changes is not supported by protocol
version 3 that they used.</p>
<p>With <a href="../glossary.html#ist">IST</a> involved on joining the last node, the smart IST flow is triggered
to take care of the upgrade even before MySQL starts to look at the
data directory.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is not recommended to restart the last node without upgrading it.</p>
</div>
<!-- Scenario: Upgrading with active parallel read-write workload
-------------------------------------------------------------------------------- -->
<!-- The upgrade prosess is similar to that described in
:ref:`upgrading-rolling-no-active-read-only-parallel-workload`: since
the cluster state keeps changing while each node is taken down and
upgraded, :term:`IST` or :term:`SST` is triggered when rejoining the
node that you upgrading. In |version|, PXC clears the configuration
of each replica node (via `RESET SLAVE ALL <https://dev.mysql.com/doc/refman/8.0/en/reset-slave.html>`_). -->
<!-- important:

It is important that the joining node have enough replica threads to catch up
IST write-sets and cluster write-sets. -->
<!-- Scenario: Adding 8.0 node to a 5.7 cluster
--------------------------------------------------------------------------------

Instead of upgrading a node in a 5.7 cluster to PXC 8.0, you are booting a
fresh 8.0 node and try joining it as an additional node.

Suppose the 5.7 cluster is already active and has processed write-sets. The new
8.0 node joins the cluster and gets a dump of the cluster through :term:`SST`
and remains part of the cluster.

Since the underline protocol version negotiated in both cases is based on Galera 3,
the 8.0 node will fail to service galera 4 features. As soon as all 5.7
nodes leave the cluster, the 8.0 nodes re-negotiates using protocol version 4
and gets a proper local index and other properties assigned.

.. warning:

   Joining a 5.7 node to a PXC |version| cluster is not supported. -->
<!-- Scenario: Upgrading a node which is an async replication replica
--------------------------------------------------------------------------------

In this case, you need to configure the source-replica replication. Make one of the
PXC nodes as an async replica. Upgrade the PXC async replica node and check the
replication status. -->
<h3 id="scenario-upgrade-from-pxc-56-to-pxc-80">Scenario: Upgrade from PXC 5.6 to PXC 8.0<a class="headerlink" href="#scenario-upgrade-from-pxc-56-to-pxc-80" title="Permanent link">&para;</a></h3>
<p>First, upgrade PXC from 5.6 to the latest version of PXC 5.7. Then proceed
with the upgrade using the procedure described in
<a href="#scenario-no-active-parallel-workload-or-with-read-only-workload">Scenario: No active parallel workload or with read-only workload</a>.</p>
<h2 id="minor-upgrade">Minor upgrade<a class="headerlink" href="#minor-upgrade" title="Permanent link">&para;</a></h2>
<p>To upgrade the cluster, follow these steps for each node:</p>
<ol>
<li>
<p>Make sure that all nodes are synchronized.</p>
</li>
<li>
<p>Stop the <code>mysql</code> service:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>service<span class="w"> </span>mysql<span class="w"> </span>stop
</code></pre></div>
</li>
<li>
<p>Upgrade Percona XtraDB Cluster and Percona XtraBackup packages.
For more information, see <a href="../install/index.html#install">Installing Percona XtraDB Cluster</a>.</p>
</li>
<li>
<p>Back up <code>grastate.dat</code>, so that you can restore it
if it is corrupted or zeroed out due to network issue.</p>
</li>
<li>
<p>Now, start the cluster node with 8.0 packages installed, PXC will upgrade
the data directory as needed - either as part of the startup process or a
state transfer (IST/SST).</p>
<p>In most cases, starting the <code>mysql</code> service should run the node with your
previous configuration. For more information, see <a href="../add-node.html#add-node">Adding Nodes to Cluster</a>.</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>service<span class="w"> </span>mysql<span class="w"> </span>start
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On CentOS, the /etc/my.cnf configuration file is renamed to <code>my.cnf.rpmsave</code>. Make sure to rename it back before joining the upgraded node back to the cluster.</p>
</div>
<p><a href="../features/pxc-strict-mode.html#pxc-strict-mode">PXC Strict Mode</a> is enabled by default, which may result in denying any
unsupported operations and may halt the server. For more information, see
<a href="#pxc-strict-mode-is-enabled-by-default">pxc-strict-mode is enabled by default</a>.</p>
<p><code>pxc-encrypt-cluster-traffic</code> is enabled by default. You need to configure
each node accordingly and avoid joining a cluster with unencrypted cluster
traffic. For more information, see
<a href="#traffic-encryption-is-enabled-by-default">Traffic encryption is enabled by default</a>.</p>
</li>
<li>
<p>Repeat this procedure for the next node in the cluster
until you upgrade all nodes.</p>
</li>
</ol>

                
<div class="md-relbar2__inner md-grid">
<div class="md-content">
  <article class="md-content__inner md-typeset" role="main">    
    <h3>Contact us </h3>
    <p>For free technical help, visit the Percona <a class="reference external" href="https://forums.percona.com/c/mysql-mariadb/percona-xtradb-cluster-8-x/37" target="_blank">Community Forum</a>.<br>
      <p>To report bugs or submit feature requests, open a <a class="reference external" href="https://jira.percona.com/projects/PXC/issues" target="_blank">JIRA</a> ticket.<br>
       <p>For paid <a class="reference external" href="https://www.percona.com/services/support"> support </a> and <a class="reference external" href="https://www.percona.com/services/managed-services"> managed </a> or <a class="reference external" href="https://www.percona.com/services/consulting">consulting services </a>, contact <a class="reference external" href="https://www.percona.com/about-percona/contact" target="_blank">Percona Sales</a>.</p>
 </article>
</div>
</div>

                <!-- Last update of source file -->
                
                  
                    <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2023-03-08
    
  </small>
</div>
                  
                
              
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    <div class="md-copyright__highlight">
 <a href='https://percona.com' target='_blank'>Percona LLC and/or its affiliates, </a> &copy; 2023
    </div>
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "navigation.top", "content.tabs.link", "content.code.copy", "navigation.tracking", "content.action.edit", "content.action.view"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
              
      <script src="../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../js/version-select.js"></script>
      
        <script src="../js/promptremover.js"></script>
      
    

              <img src="https://tracking.g2crowd.com/attribution_tracking/conversions/1007137.gif?e=" width="1" height="1" />

              <noscript>
                <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K48FGP2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
              </noscript>
              
  </body>
</html>