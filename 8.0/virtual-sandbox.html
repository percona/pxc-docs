
  
  
  
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This section describes how to set up Percona XtraDB Cluster in a virtualized testing environment
based on ProxySQL. To test the cluster, we will use the sysbench benchmark
tool.">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-xtradb-cluster/8.0/virtual-sandbox.html">
      
      
        <link rel="prev" href="proxysql-v2.html">
      
      
        <link rel="next" href="wsrep-status-index.html">
      
      
      <link rel="icon" href="_static/percona-favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Set up a testing environment with ProxySQL - Percona XtraDB Cluster</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="css/percona.css">
    
      <link rel="stylesheet" href="css/nocopy.css">
    
      <link rel="stylesheet" href="css/osano.css">
    
      <link rel="stylesheet" href="css/design.css">
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-J4J70BNH0G"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-J4J70BNH0G",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-J4J70BNH0G",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  

               
               
               
               
               <meta property="og:type" content="website" />
               <meta property="og:title" content="Percona XtraDB Cluster - Set up a testing environment with ProxySQL" />
               <meta property="og:image" content="https://docs.percona.com/percona-xtradb-cluster/8.0/_static/percona-mysql-logo.png">
               <meta property="og:url" content="https://docs.percona.com/percona-xtradb-cluster/">
            </head>
            </html>

            
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="percona-light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#set-up-a-testing-environment-with-proxysql" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docs.percona.com" title="Percona XtraDB Cluster" class="md-header__button md-logo" aria-label="Percona XtraDB Cluster" data-md-component="logo">
      
  <img src="_static/percona-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Percona XtraDB Cluster
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Set up a testing environment with ProxySQL
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="percona-light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/percona/pxc-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxc-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.percona.com" title="Percona XtraDB Cluster" class="md-nav__button md-logo" aria-label="Percona XtraDB Cluster" data-md-component="logo">
      
  <img src="_static/percona-logo.svg" alt="logo">

    </a>
    Percona XtraDB Cluster
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/pxc-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Release notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/release-notes_index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release notes index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.36-28.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.36-28 (2024-04-03)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.35-27.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.35-27 (2024-01-17)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.34-26.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.34-26 (2023-11-01)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.33-25.upd.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.33-25 Update (2023-08-25)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.33-25.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.33-25 (2023-08-02)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.32-24.2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.32-24.2 (2023-05-24)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.32-24.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.32-24 (2023-04-18)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.31-23.2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.31-23.2 (2023-04-04)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.31-23.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.31-23 (2023-03-14)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.30-22.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.30-22.md (2022-12-28)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/8.0.29-21.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.29-21 (2022-09-12)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.28-19.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.28-19.1 (2022-07-19)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.27-18.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.27-18.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.26-16.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.26-16.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.25-15.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.25-15.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.23-14.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.23-14.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.22-13.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.22-13.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.21-12.1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.21-12.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.20-11.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.20-11
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.20-11.3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.20-11.3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.20-11.2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.20-11.2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.19-10.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.19-10
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="release-notes/Percona-XtraDB-Cluster-8.0.18-9.3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster 8.0.18-9.3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="intro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="limitation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster limitations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="high-availability.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High availability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="strict-mode.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster strict mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="online-schema-upgrade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Online schema upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nbo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Non-Blocking Operations (NBO) method for Online Scheme Upgrades (OSU)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quickstart guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Quickstart guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quickstart-overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart Guide for Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="get-started-cluster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get started with Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Get started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Get started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="install-index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="apt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Percona XtraDB Cluster on Debian or Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="yum.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Percona XtraDB Cluster on Red Hat Enterprise Linux and CentOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tarball.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Percona XtraDB Cluster from Binary Tarball
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="compile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compile and install from Source Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="docker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running Percona XtraDB Cluster in a Docker Container
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="configure-nodes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure nodes for write-set replication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bootstrap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bootstrap the first node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="add-node.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add nodes to cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="verify-replication.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verify replication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Upgrade
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Upgrade
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="upgrade-guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="upgrade-from-backup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restore a 5.7 backup to an 8.0 cluster
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PXC security
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            PXC security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="security-index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="secure-network.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure the network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="encrypt-traffic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encrypt PXC traffic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="apparmor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enable AppArmor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="selinux.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enable SELinux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User's manual
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            User's manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="state-snapshot-transfer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State snapshot transfer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="xtrabackup-sst.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraBackup SST configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="restarting-nodes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restart the cluster nodes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="failover.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster failover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="monitoring.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitor the cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="certification.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certification in Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="threading-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percona XtraDB Cluster threading model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gcache-record-set-cache-difference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understand GCache and Record-Set cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gcache-write-set-cache-encryption.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GCache encryption and Write-Set cache encryption
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="performance-schema-instrumentation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perfomance Schema instrumentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="data-at-rest-encryption.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data at Rest Encryption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How-tos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            How-tos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="crash-recovery.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crash recovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="configure-cluster-rhel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure a cluster on Red Hat-based distributions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="configure-cluster-ubuntu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure a cluster on Debian or Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="garbd-howto.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Set up Galera arbitrator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="singlebox.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to set up a three-node cluster on a single box
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="set-up-3nodes-ec2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to set up a three-node cluster in EC2 environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="haproxy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Load balancing with HAProxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="haproxy-config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HAProxy configuration file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="load-balance-proxysql.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Load balance with ProxySQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="proxysql-v2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ProxySQL admin utilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Set up a testing environment with ProxySQL
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="virtual-sandbox.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Set up a testing environment with ProxySQL
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adding-cluster-nodes-to-proxysql" class="md-nav__link">
    <span class="md-ellipsis">
      Adding cluster nodes to ProxySQL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxysql-failover-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      ProxySQL failover behavior
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-proxysql-monitoring-user" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a ProxySQL monitoring user
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saving-and-loading-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Saving and loading the configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-proxysql-client-user" class="md-nav__link">
    <span class="md-ellipsis">
      Creating ProxySQL Client User
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-cluster-with-the-sysbench-benchmark-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Testing the cluster with the sysbench benchmark tool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-expert-help" class="md-nav__link">
    <span class="md-ellipsis">
      Get expert help
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="wsrep-status-index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of wsrep status variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="wsrep-system-index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of wsrep system variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="wsrep-provider-index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of wsrep_provider options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="wsrep-files-index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index of files created by PXC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="telemetry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telemetry on Percona XtraDB Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="xtradb-cluster-version-numbers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understand version numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="faq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frequently asked questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="copyright-and-licensing-information.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Copyright and licensing information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="trademark-policy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trademark policy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                    <br>
                    <label class="md-nav__title" for="__drawer">
                      <a href="https://learn.percona.com/download-percona-xtradb-cluster-8-manual" onclick="_gaq.push(['b._trackEvent', 'Percona XtraDB Cluster', 'Download', 'Download Manual Percona XtraDB Cluster']);" class="md-nav__link md-nav__link--active" style="font-size: .7rem;"> Download PDF
                      </a>
                    </label> 
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adding-cluster-nodes-to-proxysql" class="md-nav__link">
    <span class="md-ellipsis">
      Adding cluster nodes to ProxySQL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxysql-failover-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      ProxySQL failover behavior
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-proxysql-monitoring-user" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a ProxySQL monitoring user
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saving-and-loading-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Saving and loading the configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-proxysql-client-user" class="md-nav__link">
    <span class="md-ellipsis">
      Creating ProxySQL Client User
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-the-cluster-with-the-sysbench-benchmark-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Testing the cluster with the sysbench benchmark tool
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-expert-help" class="md-nav__link">
    <span class="md-ellipsis">
      Get expert help
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/percona/pxc-docs/edit/8.0/docs/virtual-sandbox.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/percona/pxc-docs/raw/8.0/docs/virtual-sandbox.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="set-up-a-testing-environment-with-proxysql">Set up a testing environment with ProxySQL<a class="headerlink" href="#set-up-a-testing-environment-with-proxysql" title="Permanent link">&para;</a></h1>
<p>This section describes how to set up Percona XtraDB Cluster in a virtualized testing environment
based on ProxySQL. To test the cluster, we will use the sysbench benchmark
tool.</p>
<p>It is assumed that each PXC node is installed on Amazon EC2 micro instances
running CentOS 7.  However, the information in this section should apply if you
used another virtualization technology (for example, VirtualBox) with any Linux
distribution.</p>
<p>Each of the tree Percona XtraDB Cluster nodes is installed on a separate virtual machine. One
more virtual machine has ProxySQL, which redirects requests to the nodes.</p>
<div class="admonition admonition">
<p class="admonition-title">Tip</p>
<p>Running ProxySQL on an application server, instead of having it as a dedicated entity, removes the unnecessary extra network roundtrip, because the load balancing layer in Percona XtraDB Cluster scales well with application servers.</p>
</div>
<ol>
<li>
<p>Install Percona XtraDB Cluster on three cluster nodes, as described in <a href="configure-cluster-rhel.html#centos-howto">Configuring Percona XtraDB Cluster on CentOS</a>.</p>
</li>
<li>
<p>On the client node, install <a href="load-balance-proxysql.html#load-balancing-with-proxysql">ProxySQL</a> and <code>sysbench</code>:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>proxysql2<span class="w"> </span>sysbench
</code></pre></div>
</li>
<li>
<p>When all cluster nodes are started, configure ProxySQL using the admin
interface.</p>
<div class="admonition admonition">
<p class="admonition-title">Tip</p>
<p>To connect to the ProxySQL admin interface, you need a <code>mysql</code> client.
You can either connect to the admin interface from Percona XtraDB Cluster nodes
that already have the <code>mysql</code> client installed (Node 1, Node 2, Node 3)
or install the client on Node 4 and connect locally.</p>
</div>
<p>To connect to the admin interface, use the credentials, host name and port
specified in the <a href="https://github.com/sysown/proxysql/blob/master/doc/global_variables.md">global variables</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use default credentials in production!</p>
</div>
<p>The following example shows how to connect to the ProxySQL admin interface
with default credentials (assuming that ProxySQL IP is 192.168.70.74):</p>
<div class="highlight" data-prompt="root@proxysql:~#"><pre><span></span><code>root@proxysql:~#<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>admin<span class="w"> </span>-padmin<span class="w"> </span>-h<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>-P<span class="w"> </span><span class="m">6032</span>
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.5.30 (ProxySQL Admin Module)

Copyright (c) 2009-2020 Percona LLC and/or its affiliates
Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt;
</code></pre></div>
</details>
<p>To see the ProxySQL databases and tables use the <code>SHOW DATABASES</code> and
<code>SHOW TABLES</code> commands:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SHOW<span class="w"> </span>DATABASES<span class="p">;</span>
</code></pre></div>
<p>The following output shows the list of the ProxySQL databases:</p>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>+-----+---------------+-------------------------------------+
| seq | name          | file                                |
+-----+---------------+-------------------------------------+
| 0   | main          |                                     |
| 2   | disk          | /var/lib/proxysql/proxysql.db       |
| 3   | stats         |                                     |
| 4   | monitor       |                                     |
| 5   | stats_monitor | /var/lib/proxysql/proxysql_stats.db |
+-----+---------------+-------------------------------------+
5 rows in set (0.00 sec)
</code></pre></div>
</details>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SHOW<span class="w"> </span>TABLES<span class="p">;</span>
</code></pre></div>
<p>The following output shows the list of tables:</p>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>+----------------------------------------------------+
| tables                                             |
+----------------------------------------------------+
| global_variables                                   |
| mysql_aws_aurora_hostgroups                        |
| mysql_collations                                   |
| mysql_firewall_whitelist_rules                     |
| mysql_firewall_whitelist_sqli_fingerprints         |
| mysql_firewall_whitelist_users                     |
| mysql_galera_hostgroups                            |
| mysql_group_replication_hostgroups                 |
| mysql_query_rules                                  |
| mysql_query_rules_fast_routing                     |
| mysql_replication_hostgroups                       |
| mysql_servers                                      |
| mysql_users                                        |
| proxysql_servers                                   |
| restapi_routes                                     |
| runtime_checksums_values                           |
| runtime_global_variables                           |
| runtime_mysql_aws_aurora_hostgroups                |
| runtime_mysql_firewall_whitelist_rules             |
| runtime_mysql_firewall_whitelist_sqli_fingerprints |
| runtime_mysql_firewall_whitelist_users             |
| runtime_mysql_galera_hostgroups                    |
| runtime_mysql_group_replication_hostgroups         |
| runtime_mysql_query_rules                          |
| runtime_mysql_query_rules_fast_routing             |
| runtime_mysql_replication_hostgroups               |
| runtime_mysql_servers                              |
| runtime_mysql_users                                |
| runtime_proxysql_servers                           |
| runtime_restapi_routes                             |
| runtime_scheduler                                  |
| scheduler                                          |
+----------------------------------------------------+
32 rows in set (0.00 sec)
</code></pre></div>
</details>
<p>For more information about admin databases and tables, see <a href="https://github.com/sysown/proxysql/blob/master/doc/admin_tables.md">Admin Tables</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ProxySQL has 3 areas where the configuration can reside:</p>
<ul>
<li>
<p>MEMORY (your current working place)</p>
</li>
<li>
<p>RUNTIME (the production settings)</p>
</li>
<li>
<p>DISK (durable configuration, saved inside an SQLITE database)</p>
</li>
</ul>
<p>When you change a parameter, you change it in MEMORY area.
That is done by design to allow you to test the changes
before pushing to production (RUNTIME), or saving them to disk.</p>
</div>
</li>
</ol>
<h3 id="adding-cluster-nodes-to-proxysql">Adding cluster nodes to ProxySQL<a class="headerlink" href="#adding-cluster-nodes-to-proxysql" title="Permanent link">&para;</a></h3>
<p>To configure the backend Percona XtraDB Cluster nodes in ProxySQL, insert corresponding
records into the mysql_servers table.</p>
<div class="highlight"><pre><span></span><code><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">mysql_servers</span><span class="w"> </span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span><span class="n">hostgroup_id</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;192.168.70.71&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3306</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">mysql_servers</span><span class="w"> </span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span><span class="n">hostgroup_id</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;192.168.70.72&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3306</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">mysql_servers</span><span class="w"> </span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span><span class="n">hostgroup_id</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;192.168.70.73&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3306</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
</code></pre></div>
<p>ProxySQL v2.0 supports PXC natlively. It uses the concept of <em>hostgroups</em>
(see the value of hostgroup_id in the mysql_servers table) to group cluster
nodes to balance the load in a cluster by routing different types of traffic to
different groups.</p>
<p>This information is stored in the [runtime_]mysql_galera_hostgroups table.</p>
<p><strong>Columns of the <code>[runtime_]mysql_galera_hostgroups</code> table</strong></p>
<table>
<thead>
<tr>
<th>Column name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>writer_hostgroup:</td>
<td>The ID of the hostgroup that refers to the WRITER node</td>
</tr>
<tr>
<td>backup_writer_hostgroup</td>
<td>The ID of the hostgroup that contains candidate WRITER servers</td>
</tr>
<tr>
<td>reader_hostgroup</td>
<td>The ID of the hostgroup that contains candidate READER servers</td>
</tr>
<tr>
<td>offline_hostgroup</td>
<td>The ID of the hostgroup that will eventually contain the WRITER node that will be put OFFLINE</td>
</tr>
<tr>
<td>active</td>
<td><code>1</code> (Yes) to inidicate that this configuration should be used; <code>0</code>  (No) - otherwise</td>
</tr>
<tr>
<td>max_writers</td>
<td>The maximum number of WRITER nodes that must operate simultaneously. For most cases, a reasonable value is <code>1</code>. The value in this column may not exceed the total number of nodes.</td>
</tr>
<tr>
<td>writer_is_also_reader</td>
<td><code>1</code> (Yes) to keep the given node in both <code>reader_hostgroup</code> and <code>writer_hostgroup</code>. <code>0</code> (No) to remove the given node from <code>reader_hostgroup</code> if it already belongs to <code>writer_hostgroup</code>.</td>
</tr>
<tr>
<td>max_transactions_behind</td>
<td>As soon as the value of :variable:<code>wsrep_local_recv_queue</code> exceeds the number stored in this column the given node is set to <code>OFFLINE</code>. Set the value carefully based on the behaviour of the node.</td>
</tr>
<tr>
<td>comment</td>
<td>Helpful extra information about the given node</td>
</tr>
</tbody>
</table>
<p>Make sure that the variable mysql-server_version refers to the correct
version. For Percona XtraDB Cluster 8.0, set it to 8.0 accordingly:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>UPDATE<span class="w"> </span>GLOBAL_VARIABLES
SET<span class="w"> </span><span class="nv">variable_value</span><span class="o">=</span><span class="s1">&#39;8.0&#39;</span>
WHERE<span class="w"> </span><span class="nv">variable_name</span><span class="o">=</span><span class="s1">&#39;mysql-server_version&#39;</span><span class="p">;</span>

mysql&gt;<span class="w"> </span>LOAD<span class="w"> </span>MYSQL<span class="w"> </span>SERVERS<span class="w"> </span>TO<span class="w"> </span>RUNTIME<span class="p">;</span>
mysql&gt;<span class="w"> </span>SAVE<span class="w"> </span>MYSQL<span class="w"> </span>SERVERS<span class="w"> </span>TO<span class="w"> </span>DISK<span class="p">;</span>
</code></pre></div>
<div class="admonition admonition">
<p class="admonition-title">See also</p>
<p>Percona Blogpost: ProxySQL Native Support for Percona XtraDB Cluster (PXC) https://www.percona.com/blog/2019/02/20/proxysql-native-support-for-percona-xtradb-cluster-pxc/</p>
</div>
<p>Given the nodes from the mysql_servers table, you may set up the hostgroups as
follows:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>mysql_galera_hostgroups<span class="w"> </span><span class="o">(</span>
writer_hostgroup,<span class="w"> </span>backup_writer_hostgroup,<span class="w"> </span>reader_hostgroup,
offline_hostgroup,<span class="w"> </span>active,<span class="w"> </span>max_writers,<span class="w"> </span>writer_is_also_reader,
max_transactions_behind<span class="o">)</span>
VALUES<span class="w"> </span><span class="o">(</span><span class="m">10</span>,<span class="w"> </span><span class="m">12</span>,<span class="w"> </span><span class="m">11</span>,<span class="w"> </span><span class="m">13</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="p">;</span>
</code></pre></div>
<p>This command configures ProxySQL as follows:</p>
<p>WRITER hostgroup</p>
<div class="highlight"><pre><span></span><code>hostgroup `10`
</code></pre></div>
<p>READER hostgroup</p>
<div class="highlight"><pre><span></span><code>hostgroup `11`
</code></pre></div>
<p>BACKUP WRITER hostgroup</p>
<div class="highlight"><pre><span></span><code>hostgroup `12`
</code></pre></div>
<p>OFFLINE hostgroup</p>
<div class="highlight"><pre><span></span><code>hostgroup `13`
</code></pre></div>
<p>Set up ProxySQL query rules for read/write split using the mysql_query_rules
table:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>mysql_query_rules<span class="w"> </span><span class="o">(</span>
username,destination_hostgroup,active,match_digest,apply<span class="o">)</span>
VALUES<span class="w"> </span><span class="o">(</span><span class="s1">&#39;appuser&#39;</span>,10,1,<span class="s1">&#39;^SELECT.*FOR UPDATE&#39;</span>,1<span class="o">)</span><span class="p">;</span>

mysql&gt;<span class="w"> </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>mysql_query_rules<span class="w"> </span><span class="o">(</span>
username,destination_hostgroup,active,match_digest,apply<span class="o">)</span>
VALUES<span class="w"> </span><span class="o">(</span><span class="s1">&#39;appuser&#39;</span>,11,1,<span class="s1">&#39;^SELECT &#39;</span>,1<span class="o">)</span><span class="p">;</span>

mysql&gt;<span class="w"> </span>LOAD<span class="w"> </span>MYSQL<span class="w"> </span>QUERY<span class="w"> </span>RULES<span class="w"> </span>TO<span class="w"> </span>RUNTIME<span class="p">;</span>
mysql&gt;<span class="w"> </span>SAVE<span class="w"> </span>MYSQL<span class="w"> </span>QUERY<span class="w"> </span>RULES<span class="w"> </span>TO<span class="w"> </span>DISK<span class="p">;</span>

mysql&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>hostgroup_id,hostname,port,status,weight<span class="w"> </span>from<span class="w"> </span>runtime_mysql_servers<span class="p">;</span>
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>+--------------+----------------+------+--------+--------+
| hostgroup_id | hostname       | port | status | weight |
+--------------+----------------+------+--------+--------+
| 10           | 192.168.70.73 | 3306  | ONLINE | 1000   |
| 11           | 192.168.70.72 | 3306  | ONLINE | 1000   |
| 11           | 192.168.70.71 | 3306  | ONLINE | 1000   |
| 12           | 192.168.70.72 | 3306  | ONLINE | 1000   |
| 12           | 192.168.70.71 | 3306  | ONLINE | 1000   |
+--------------+----------------+------+--------+--------+
5 rows in set (0.00 sec)
</code></pre></div>
</details>
<div class="admonition admonition">
<p class="admonition-title">See also</p>
<p>ProxySQL Blog: MySQL read/write split with ProxySQL
  https://proxysql.com/blog/configure-read-write-split/
ProxySQL Documentation: <code>mysql_query_rules</code> table
  https://github.com/sysown/proxysql/wiki/Main-(runtime)#mysql_query_rules</p>
</div>
<h3 id="proxysql-failover-behavior">ProxySQL failover behavior<a class="headerlink" href="#proxysql-failover-behavior" title="Permanent link">&para;</a></h3>
<p>Notice that all servers were inserted into the mysql_servers table with the
READER hostgroup set to 10 (see the value of the hostgroup_id column):</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>mysql_servers<span class="p">;</span>
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>+--------------+---------------+------+--------+     +---------+
| hostgroup_id | hostname      | port | weight | ... | comment |
+--------------+---------------+------+--------+     +---------+
| 10           | 192.168.70.71 | 3306 | 1000   |     |         |
| 10           | 192.168.70.72 | 3306 | 1000   |     |         |
| 10           | 192.168.70.73 | 3306 | 1000   |     |         |
+--------------+---------------+------+--------+     +---------+
3 rows in set (0.00 sec)
</code></pre></div>
</details>
<p>This configuration implies that ProxySQL elects the writer automatically. If
the elected writer goes offline, ProxySQL assigns another (failover). You
might tweak this mechanism by assigning a higher weight to a selected
node. ProxySQL directs all write requests to this node. However, it also
becomes the mostly utilized node for reading requests. In case of a failback (a
node is put back online), the node with the highest weight is automatically
elected for write requests.</p>
<!-- seealso: :ref:`proxysql.automatic-failover` -->
<h3 id="creating-a-proxysql-monitoring-user">Creating a ProxySQL monitoring user<a class="headerlink" href="#creating-a-proxysql-monitoring-user" title="Permanent link">&para;</a></h3>
<p>To enable monitoring of Percona XtraDB Cluster nodes in ProxySQL, create a user with <code>USAGE</code>
privilege on any node in the cluster and configure the user in ProxySQL.</p>
<p>The following example shows how to add a monitoring user on Node 2:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>CREATE<span class="w"> </span>USER<span class="w"> </span><span class="s1">&#39;proxysql&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="w"> </span>IDENTIFIED<span class="w"> </span>WITH<span class="w"> </span>mysql_native_password<span class="w"> </span>BY<span class="w"> </span><span class="s1">&#39;ProxySQLPa55&#39;</span><span class="p">;</span>
mysql&gt;<span class="w"> </span>GRANT<span class="w"> </span>USAGE<span class="w"> </span>ON<span class="w"> </span>*.*<span class="w"> </span>TO<span class="w"> </span><span class="s1">&#39;proxysql&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="p">;</span>
</code></pre></div>
<p>The following example shows how to configure this user on the ProxySQL node:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>UPDATE<span class="w"> </span>global_variables<span class="w"> </span>SET<span class="w"> </span><span class="nv">variable_value</span><span class="o">=</span><span class="s1">&#39;proxysql&#39;</span>
WHERE<span class="w"> </span><span class="nv">variable_name</span><span class="o">=</span><span class="s1">&#39;mysql-monitor_username&#39;</span><span class="p">;</span>

mysql&gt;<span class="w"> </span>UPDATE<span class="w"> </span>global_variables<span class="w"> </span>SET<span class="w"> </span><span class="nv">variable_value</span><span class="o">=</span><span class="s1">&#39;ProxySQLPa55&#39;</span>
WHERE<span class="w"> </span><span class="nv">variable_name</span><span class="o">=</span><span class="s1">&#39;mysql-monitor_password&#39;</span><span class="p">;</span>
</code></pre></div>
<h3 id="saving-and-loading-the-configuration">Saving and loading the configuration<a class="headerlink" href="#saving-and-loading-the-configuration" title="Permanent link">&para;</a></h3>
<p>To load this configuration at runtime, issue the <code>LOAD</code> command.  To save these
changes to disk (ensuring that they persist after ProxySQL shuts down), issue
the <code>SAVE</code> command.</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>LOAD<span class="w"> </span>MYSQL<span class="w"> </span>VARIABLES<span class="w"> </span>TO<span class="w"> </span>RUNTIME<span class="p">;</span>
mysql&gt;<span class="w"> </span>SAVE<span class="w"> </span>MYSQL<span class="w"> </span>VARIABLES<span class="w"> </span>TO<span class="w"> </span>DISK<span class="p">;</span>
</code></pre></div>
<p>To ensure that monitoring is enabled, check the monitoring logs:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>monitor.mysql_server_connect_log<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>time_start_us<span class="w"> </span>DESC<span class="w"> </span>LIMIT<span class="w"> </span><span class="m">6</span><span class="p">;</span>
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>+---------------+------+------------------+----------------------+---------------+
| hostname      | port | time_start_us    | connect_success_time | connect_error |
+---------------+------+------------------+----------------------+---------------+
| 192.168.70.71 | 3306 | 1469635762434625 | 1695                 | NULL          |
| 192.168.70.72 | 3306 | 1469635762434625 | 1779                 | NULL          |
| 192.168.70.73 | 3306 | 1469635762434625 | 1627                 | NULL          |
| 192.168.70.71 | 3306 | 1469635642434517 | 1557                 | NULL          |
| 192.168.70.72 | 3306 | 1469635642434517 | 2737                 | NULL          |
| 192.168.70.73 | 3306 | 1469635642434517 | 1447                 | NULL          |
+---------------+------+------------------+----------------------+---------------+
6 rows in set (0.00 sec)
</code></pre></div>
</details>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>monitor.mysql_server_ping_log<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>time_start_us<span class="w"> </span>DESC<span class="w"> </span>LIMIT<span class="w"> </span><span class="m">6</span><span class="p">;</span>
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>+---------------+------+------------------+-------------------+------------+
| hostname      | port | time_start_us    | ping_success_time | ping_error |
+---------------+------+------------------+-------------------+------------+
| 192.168.70.71 | 3306 | 1469635762416190 | 948               | NULL       |
| 192.168.70.72 | 3306 | 1469635762416190 | 803               | NULL       |
| 192.168.70.73 | 3306 | 1469635762416190 | 711               | NULL       |
| 192.168.70.71 | 3306 | 1469635702416062 | 783               | NULL       |
| 192.168.70.72 | 3306 | 1469635702416062 | 631               | NULL       |
| 192.168.70.73 | 3306 | 1469635702416062 | 542               | NULL       |
+---------------+------+------------------+-------------------+------------+
6 rows in set (0.00 sec)
</code></pre></div>
</details>
<p>The previous examples show that ProxySQL is able to connect and ping the nodes
you added.</p>
<p>To enable monitoring of these nodes, load them at runtime:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>LOAD<span class="w"> </span>MYSQL<span class="w"> </span>SERVERS<span class="w"> </span>TO<span class="w"> </span>RUNTIME<span class="p">;</span>
</code></pre></div>
<h3 id="creating-proxysql-client-user">Creating ProxySQL Client User<a class="headerlink" href="#creating-proxysql-client-user" title="Permanent link">&para;</a></h3>
<p>ProxySQL must have users that can access backend nodes to manage connections.</p>
<p>To add a user, insert credentials into <code>mysql_users</code> table:</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>mysql_users<span class="w"> </span><span class="o">(</span>username,password<span class="o">)</span><span class="w"> </span>VALUES<span class="w"> </span><span class="o">(</span><span class="s1">&#39;appuser&#39;</span>,<span class="s1">&#39;$3kRetp@$sW0rd&#39;</span><span class="o">)</span><span class="p">;</span>
</code></pre></div>
<p>The example of the output is the following:</p>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>Query OK, 1 row affected (0.00 sec)
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ProxySQL currently doesn’t encrypt passwords.</p>
<div class="admonition admonition">
<p class="admonition-title">See also</p>
<p><a href="https://github.com/sysown/proxysql/wiki/MySQL-8.0">More information about password encryption in ProxySQL</a></p>
</div>
</div>
<p>Load the user into runtime space and save these changes to disk (ensuring that
they persist after ProxySQL shuts down):</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>LOAD<span class="w"> </span>MYSQL<span class="w"> </span>USERS<span class="w"> </span>TO<span class="w"> </span>RUNTIME<span class="p">;</span>
mysql&gt;<span class="w"> </span>SAVE<span class="w"> </span>MYSQL<span class="w"> </span>USERS<span class="w"> </span>TO<span class="w"> </span>DISK<span class="p">;</span>
</code></pre></div>
<p>To confirm that the user has been set up correctly, you can try to log in:</p>
<div class="highlight" data-prompt="root@proxysql:~#"><pre><span></span><code>root@proxysql:~#<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>appuser<span class="w"> </span>-p<span class="nv">$3</span>kRetp@<span class="nv">$sW0rd</span><span class="w"> </span>-h<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>-P<span class="w"> </span><span class="m">6033</span>
</code></pre></div>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1491
Server version: 5.5.30 (ProxySQL)

Copyright (c) 2009-2020 Percona LLC and/or its affiliates
Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
</code></pre></div>
<p>To provide read/write access to the cluster for ProxySQL, add this user on one
of the Percona XtraDB Cluster nodes:</p>
</details>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>CREATE<span class="w"> </span>USER<span class="w"> </span><span class="s1">&#39;appuser&#39;</span>@<span class="s1">&#39;192.168.70.74&#39;</span>
IDENTIFIED<span class="w"> </span>WITH<span class="w"> </span>mysql_native_password<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;$3kRetp@$sW0rd&#39;</span><span class="p">;</span>

mysql&gt;<span class="w"> </span>GRANT<span class="w"> </span>ALL<span class="w"> </span>ON<span class="w"> </span>*.*<span class="w"> </span>TO<span class="w"> </span><span class="s1">&#39;appuser&#39;</span>@<span class="s1">&#39;192.168.70.74&#39;</span><span class="p">;</span>
</code></pre></div>
<h2 id="testing-the-cluster-with-the-sysbench-benchmark-tool">Testing the cluster with the sysbench benchmark tool<a class="headerlink" href="#testing-the-cluster-with-the-sysbench-benchmark-tool" title="Permanent link">&para;</a></h2>
<p>After you set up Percona XtraDB Cluster in your testing environment, you can test it using
the <code>sysbench</code> benchmarking tool.</p>
<ol>
<li>
<p>Create a database (sysbenchdb in this example; you can use a
different name):</p>
<div class="highlight" data-prompt="mysql>"><pre><span></span><code>mysql&gt;<span class="w"> </span>CREATE<span class="w"> </span>DATABASE<span class="w"> </span>sysbenchdb<span class="p">;</span>
</code></pre></div>
<p>The following output confirms that a new database has been created:</p>
<details class="example">
<summary>Expected output</summary>
<div class="no-copy highlight"><pre><span></span><code>Query OK, 1 row affected (0.01 sec)
</code></pre></div>
</details>
</li>
<li>
<p>Populate the table with data for the benchmark. Note that you
    should pass the database you have created as the value of the
    <code>--mysql-db</code> parameter, and the name of the user who has full
    access to this database as the value of the <code>--mysql-user</code>
    parameter:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>sysbench<span class="w"> </span>/usr/share/sysbench/oltp_insert.lua<span class="w"> </span>--mysql-db<span class="o">=</span>sysbenchdb<span class="w"> </span><span class="se">\</span>
--mysql-host<span class="o">=</span><span class="m">127</span>.0.0.1<span class="w"> </span>--mysql-port<span class="o">=</span><span class="m">6033</span><span class="w"> </span>--mysql-user<span class="o">=</span>appuser<span class="w"> </span><span class="se">\</span>
--mysql-password<span class="o">=</span><span class="nv">$3</span>kRetp@<span class="nv">$sW0rd</span><span class="w"> </span>--db-driver<span class="o">=</span>mysql<span class="w"> </span>--threads<span class="o">=</span><span class="m">10</span><span class="w"> </span>--tables<span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="se">\</span>
--table-size<span class="o">=</span><span class="m">1000</span><span class="w"> </span>prepare
</code></pre></div>
</li>
<li>
<p>Run the benchmark on port 6033:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>sysbench<span class="w"> </span>/usr/share/sysbench/oltp_read_write.lua<span class="w"> </span>--mysql-db<span class="o">=</span>sysbenchdb<span class="w"> </span><span class="se">\</span>
--mysql-host<span class="o">=</span><span class="m">127</span>.0.0.1<span class="w"> </span>--mysql-port<span class="o">=</span><span class="m">6033</span><span class="w"> </span>--mysql-user<span class="o">=</span>appuser<span class="w"> </span><span class="se">\</span>
--mysql-password<span class="o">=</span><span class="nv">$3</span>kRetp@<span class="nv">$sW0rd</span><span class="w"> </span>--db-driver<span class="o">=</span>mysql<span class="w"> </span>--threads<span class="o">=</span><span class="m">10</span><span class="w"> </span>--tables<span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="se">\</span>
--skip-trx<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--table-size<span class="o">=</span><span class="m">1000</span><span class="w"> </span>--time<span class="o">=</span><span class="m">100</span><span class="w"> </span>--report-interval<span class="o">=</span><span class="m">10</span><span class="w"> </span>run
</code></pre></div>
</li>
</ol>
<hr />
<p><strong>Related sections and additional reading</strong></p>
<ul>
<li><a href="load-balance-proxysql.html#load-balancing-with-proxysql">Load balancing with ProxySQL</a></li>
<li><a href="configure-cluster-rhel.html#centos-howto">Configuring Percona XtraDB Cluster on CentOS</a></li>
<li><a href="https://www.percona.com/blog/2019/02/20/proxysql-native-support-for-percona-xtradb-cluster-pxc/">Percona Blog post: ProxySQL Native Support for Percona XtraDB Cluster (PXC)</a></li>
<li><a href="https://github.com/akopytov/sysbench/">GitHub repository for the sysbench benchmarking tool</a></li>
</ul>
<div data-banner="data-banner">
<h2 class="title" id="get-expert-help">Get expert help<a class="headerlink" href="#get-expert-help" title="Permanent link">&para;</a></h2>
<p>If you need assistance, visit the community forum for comprehensive and free database knowledge, or contact our Percona Database Experts for professional support and services.</p>
<div class="actions">
<p><a href="https://forums.percona.com/" target="_blank"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 4v7H5.17L4 12.17V4h11m1-2H3a1 1 0 0 0-1 1v14l4-4h10a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1m5 4h-2v9H6v2a1 1 0 0 0 1 1h11l4 4V7a1 1 0 0 0-1-1Z"/></svg></span> Community Forum</a> <a href="https://www.percona.com/about/contact" target="_blank"><span class="twemoji"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M19.3996 14.148C21.9082 12.5083 22.7289 9.16368 21.2109 6.53493C20.4502 5.21636 19.2207 4.27206 17.7497 3.87776C16.3868 3.51187 14.9634 3.6615 13.7106 4.29444L12 1.33337L8.44934 7.48295L0.242432 21.6959H23.7576L19.3996 14.148ZM17.3474 5.38416C18.4167 5.66894 19.3064 6.35548 19.8606 7.31143C20.9499 9.19582 20.384 11.5859 18.6176 12.7931L14.4917 5.64797C15.3806 5.22055 16.3831 5.12734 17.3474 5.38416ZM12 4.45432L21.0533 20.135H15.7562L9.35029 9.04341L11.9995 4.45478L12 4.45432ZM2.94667 20.135L8.44888 10.6071L13.9511 20.135H2.94667Z"/>
</svg></span> Get a Percona Expert</a></p>
</div>
</div>
<hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2023-07-21
    
  </small>
</div>

  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thank you for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thank you for your feedback! Help us improve by following this <a href="https://docs.google.com/forms/d/1bkWACehjqlwA0AKf-qTJcXvYbOSYgze8iTPXjntqmNo/edit" target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    <div class="md-copyright__highlight">
 <a href='https://percona.com' target='_blank'>Percona LLC and/or its affiliates, </a> &copy; 2024
 <a href="#" onclick="Osano.cm.showDrawer('osano-cm-dom-info-dialog-open')">Cookie Preferences</a>    
</div>
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["search.highlight", "navigation.top", "content.tabs.link", "content.code.copy", "navigation.tracking", "content.action.edit", "content.action.view"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
  <script src="https://cmp.osano.com/Azqe5vTyLOSbN3OuT/49ad85b5-0418-4794-ab81-7599dddd534c/osano.js"></script>
  
      <script src="assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="js/version-select.js"></script>
      
        <script src="js/promptremover.js"></script>
      
        <script src="js/consent.js"></script>
      
    
  
  </body>
</html>