



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-xtradb-cluster-docs/5.7/5.7/howtos/proxysql-v1.html">
      
      
      
      <link rel="icon" href="../_static/percona-favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>Using ProxySQL v1 with `proxysql-admin` - Percona XtraDB Cluster</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="../css/percona.css">
    
      <link rel="stylesheet" href="../css/nocopy.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-343802-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
              

              <script>
              (function (w, d, s, l, i) {
                  w[l] = w[l] || []; w[l].push({
                    'gtm.start': new Date().getTime(), 
                    event: 'gtm.js'
                  });
                  var f = d.getElementsByTagName(s)[0],
                  j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
                  j.async = true; 
                  j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
                  f.parentNode.insertBefore(j, f);
                })(window, document, 'script', 'dataLayer', 'GTM-K48FGP2');
              </script>
              
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-proxysql-v1-with-proxysql-admin" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docs.percona.com" title="Percona XtraDB Cluster" class="md-header__button md-logo" aria-label="Percona XtraDB Cluster" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Percona XtraDB Cluster
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using ProxySQL v1 with `proxysql-admin`
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/percona/pxc-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxc-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.percona.com" title="Percona XtraDB Cluster" class="md-nav__button md-logo" aria-label="Percona XtraDB Cluster" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    Percona XtraDB Cluster
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/pxc-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxc-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro.html" class="md-nav__link">
        About Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../limitation.html" class="md-nav__link">
        Percona XtraDB Cluster Limitations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtradb-cluster-version-numbers.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7 version numbers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        Quick Start Guide for Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install/index.html" class="md-nav__link">
        Installing Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configure.html" class="md-nav__link">
        Configuring Nodes for Write-Set Replication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bootstrap.html" class="md-nav__link">
        Bootstrapping the First Node
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add-node.html" class="md-nav__link">
        Adding Nodes to Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../verify.html" class="md-nav__link">
        Verifying Replication
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/highavailability.html" class="md-nav__link">
        High Availability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/multimaster-replication.html" class="md-nav__link">
        Multi-Source Replication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../features/pxc-strict-mode.html" class="md-nav__link">
        PXC Strict Mode
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          PXC Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          PXC Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/index.html" class="md-nav__link">
        Security Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/secure-network.html" class="md-nav__link">
        Securing the Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/encrypt-traffic.html" class="md-nav__link">
        Encrypting PXC Traffic
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          User's Manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          User's Manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/state_snapshot_transfer.html" class="md-nav__link">
        State Snapshot Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/xtrabackup_sst.html" class="md-nav__link">
        Percona XtraBackup SST Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/restarting_nodes.html" class="md-nav__link">
        Restarting the cluster nodes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/failover.html" class="md-nav__link">
        Cluster Failover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/monitoring.html" class="md-nav__link">
        Monitoring the cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/certification.html" class="md-nav__link">
        Certification in Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/threading_model.html" class="md-nav__link">
        Percona XtraDB Cluster threading model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/gcache_record-set_cache_difference.html" class="md-nav__link">
        Understanding GCache and Record-Set Cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual/performance_schema_instrumentation.html" class="md-nav__link">
        Perfomance Schema Instrumentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../management/data_at_rest_encryption.html" class="md-nav__link">
        Data at Rest Encryption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../management/configure-timeoutstartsec.html" class="md-nav__link">
        Configure Systemd TimeoutStartSec
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Flexibility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Flexibility
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flexibility/binlogging_replication_improvements.html" class="md-nav__link">
        Binlogging and replication improvements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flexibility/innodb_fts_improvements.html" class="md-nav__link">
        InnoDB Full-Text Search improvements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../performance/aio_page_requests.html" class="md-nav__link">
        Multiple page asynchronous I/O requests
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Diagnostics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Diagnostics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../diagnostics/innodb_fragmentation_count.html" class="md-nav__link">
        InnoDB Page Fragmentation Counters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../diagnostics/libcoredumper.html" class="md-nav__link">
        Using libcoredumper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../diagnostics/stacktrace.html" class="md-nav__link">
        Stack Trace
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          How-tos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          How-tos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="upgrade_guide.html" class="md-nav__link">
        Upgrading Percona XtraDB Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="crash-recovery.html" class="md-nav__link">
        Crash Recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="centos_howto.html" class="md-nav__link">
        Configuring Percona XtraDB Cluster on CentOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ubuntu_howto.html" class="md-nav__link">
        Configuring Percona XtraDB Cluster on Ubuntu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="garbd_howto.html" class="md-nav__link">
        Setting up Galera Arbitrator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="singlebox.html" class="md-nav__link">
        How to set up a three-node cluster on a single box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="3nodesec2.html" class="md-nav__link">
        How to set up a three-node cluster in EC2 environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="haproxy.html" class="md-nav__link">
        Load balancing with HAProxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="proxysql.html" class="md-nav__link">
        Load balancing with ProxySQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="virt_sandbox.html" class="md-nav__link">
        Setting up PXC reference architecture with HAProxy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_1" >
      
      
      
        <label class="md-nav__link" for="__nav_10_1" id="__nav_10_1_label" tabindex="0">
          Release notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10_1">
          <span class="md-nav__icon md-icon"></span>
          Release notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/release-notes_index.html" class="md-nav__link">
        Release notes index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/5.7.40-31.63.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.40-31.63 (2022-12-29)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/5.7.39-31.61.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.39-31.61 (2022-08-29)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/5.7.38-31.59.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.38-31.59 (2022-06-29)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.37-31.57.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.37-31.57 (2022-05-18)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.36-31.55.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.36-31.55
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.35-31.53.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.35-31.53
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.34-31.51.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.34-31.51
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.33-31.49.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.33-31.49
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.32-31.47.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.32-31.47
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.31-31.45.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.31-31.45
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.31-31.45.2.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.31-31.45.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.31-31-45.3.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.31-31.45.3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.30-31.43.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.30-31.43
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.29-31.43.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.29-31.43
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.28-31.41.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.28-31.41
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.28-31.41.2.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.28-31.41.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.27-31.39.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.27-31.39
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.26-31.37.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.26-31.37
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.25-31.35.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.25-31.35
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.24-31.33.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.24-31.33
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.23-31.31.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.23-31.31
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.23-31.31.2.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.23-31.31.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.22-29.26.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.22-29.26
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.21-29.26.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.21-29.26
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.20-29.24.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.20-29.24
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.19-29.22.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.19-29.22
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.19-29.22-3.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.19-29.22-3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.18-29.20.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.18-29.20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.17-29.20.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.17-29.20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.17-27.20.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.17-27.20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.16-27.19.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.16-27.19
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.14-26.17.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.14-26.17
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.12-5rc1-26.16.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.12-5rc1-26.16
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/Percona-XtraDB-Cluster-5.7.11-4beta-25.14.2.html" class="md-nav__link">
        Percona XtraDB Cluster 5.7.11-4beta-25.14.2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-status-index.html" class="md-nav__link">
        Index of wsrep status variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-system-index.html" class="md-nav__link">
        Index of wsrep system variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-provider-index.html" class="md-nav__link">
        Index of wsrep_provider options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wsrep-files-index.html" class="md-nav__link">
        Index of files created by PXC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq.html" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../copyright-and-licensing-information.html" class="md-nav__link">
        Copyright and licensing information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trademark-policy.html" class="md-nav__link">
        Trademark policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
    <br/>
   <label class="md-nav__title" for="__drawer">
    <a href="https://learn.percona.com/download-percona-xtradb-cluster-5-7-manual" onclick="_gaq.push(['b._trackEvent', 'Percona XtraBackup', 'Download', 'Download Manual Percona XtraBackup']);" class="md-nav__link md-nav__link--active">
      Download PDF
    </a>
  </label> 
  </ul>
</nav>

                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                <!-- Edit and view button -->
                
                  
                  
                  <a
                    href="https://github.com/percona/pxc-docs/edit/5.7/docs/howtos/proxysql-v1.md"
                    title=""
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
                  </a>
                  <a
                    href="https://raw.githubusercontent.com/percona/pxc-docs/5.7/docs/howtos/proxysql-v1.md"
                    title="View source of this page"
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
                  </a>
                

                <!--
                  Hack: check whether the content contains a h1 headline. If it
                  doesn't, the page title (or respectively site name) is used
                  as the main headline.
                -->
                

                <!-- Markdown content -->
                <h1 id="using-proxysql-v1-with-proxysql-admin">Using ProxySQL v1 with <code>proxysql-admin</code><a class="headerlink" href="#using-proxysql-v1-with-proxysql-admin" title="Permanent link">&para;</a></h1>
<p>ProxySQL Version 1.4 does not natively support Percona XtraDB Cluster and <code>proxysql-admin</code> tool
requires custom bash scripts to keep track of PXC status:
<code>proxysql_galera_checker</code> and <code>proxysql_node_monitor</code>.</p>
<h1 id="installing-proxysql-v1">Installing ProxySQL v1<a class="headerlink" href="#installing-proxysql-v1" title="Permanent link">&para;</a></h1>
<p>If that is what you used to <a href="../install/index.html#install">install PXC</a> or any other Percona
software, run the corresponding command:</p>
<ul>
<li>On Debian or Ubuntu:</li>
</ul>
<p><code>shell
  $ sudo apt install proxysql</code></p>
<ul>
<li>On Red Hat Enterprise Linux or CentOS:</li>
</ul>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>proxysql
</code></pre></div>
<p>Alternatively, you can download packages from https://www.percona.com/downloads/proxysql/.</p>
<p>To start ProxySQL, run the following command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>service<span class="w"> </span>proxysql<span class="w"> </span>start
</code></pre></div>
<p>!!! warning</p>
<div class="highlight"><pre><span></span><code>  Do not run ProxySQL with default credentials in production.

  Before starting the `proxysql` service,
  you can change the defaults in the `/etc/proxysql.cnf` file
  by changing the `admin_credentials` variable.
  For more information, see [Global Variables](https://github.com/sysown/proxysql/blob/master/doc/global_variables.md).
</code></pre></div>
<h1 id="automatic-configuration">Automatic Configuration<a class="headerlink" href="#automatic-configuration" title="Permanent link">&para;</a></h1>
<p>The <code>proxysql</code> package from Percona includes the <code>proxysql-admin</code> tool
for configuring Percona XtraDB Cluster nodes with ProxySQL.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>The <em>ProxySQL Admin</em> is specially developed by Percona to
   automate this configuration. Bug reports and feature proposals are welcome
   in the ProxySQL Admin <a href="https://jira.percona.com/projects/PSQLADM">issue tracking system</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>The <code>proxysql-admin</code> tool can only be used for <em>initial</em> ProxySQL configuration.</p>
<p>To view usage information, run <code>proxysql-admin</code> without any options:</p>
<div class="highlight"><pre><span></span><code>Usage: [ options ]
Options:
--config-file=&lt;config-file&gt;        Read login credentials from a configuration file
                                   (command line options override any configuration file login credentials)
--proxysql-datadir=&lt;datadir&gt;       Specify the proxysql data directory location
--proxysql-username=user_name      ProxySQL service username
--proxysql-password[=password]     ProxySQL service password
--proxysql-port=port_num           ProxySQL service port number
--proxysql-hostname=host_name      ProxySQL service hostname
--cluster-username=user_name       Percona XtraDB Cluster node username
--cluster-password[=password]      Percona XtraDB Cluster node password
--cluster-port=port_num            Percona XtraDB Cluster node port number
--cluster-hostname=host_name       Percona XtraDB Cluster node hostname
--cluster-app-username=user_name   Percona XtraDB Cluster node application username
--cluster-app-password[=password]  Percona XtraDB Cluster node application passwrod
--without-cluster-app-user         Configure Percona XtraDB Cluster without application user
--monitor-username=user_name       Username for monitoring Percona XtraDB Cluster nodes through ProxySQL
--monitor-password[=password]      Password for monitoring Percona XtraDB Cluster nodes through ProxySQL
--use-existing-monitor-password    Do not prompt for a new monitor password if one is provided.
--node-check-interval=3000         Interval for monitoring node checker script (in milliseconds)
                                   (default: 3000)
--mode=[loadbal|singlewrite]       ProxySQL read/write configuration mode
                                   currently supporting: &#39;loadbal&#39; and &#39;singlewrite&#39;
                                   (default: &#39;singlewrite&#39;)
--write-node=host_name:port        Writer node to accept write statments.
                                   This option is supported only when using --mode=singlewrite
                                   Can accept comma delimited list with the first listed being
                                   the highest priority.
--include-slaves=host_name:port    Add specified replica node(s) to ProxySQL, these nodes will go
                                   into the reader hostgroup and will only be put into
                                   the writer hostgroup if all cluster nodes are down (this
                                   depends on the value of --use-slave-as-writer).
                                   Replicas must be read only.  Can accept a comma delimited list.
                                   If this is used make sure &#39;read_only=1&#39; is in the replica&#39;s my.cnf
--use-slave-as-writer=&lt;yes/no&gt;     If this value is &#39;yes&#39;, then a replica may be used as a writer
                                   if the entire cluster is down. If &#39;no&#39;, then a replica
                                   will not be used as a writer. This option is required
                                   if &#39;--include-slaves&#39; is used.
--writer-is-reader=&lt;value&gt;         Defines if the writer node also accepts writes.
                                   Possible values are &#39;always&#39;, &#39;never&#39;, and &#39;ondemand&#39;.
                                   &#39;ondemand&#39; means that the writer node only accepts reads
                                   if there are no other readers.
                                   (default: &#39;ondemand&#39;)
--max-connections=&lt;NUMBER&gt;         Value for max_connections in the mysql_servers table.
                                   This is the maximum number of connections that
                                   ProxySQL will open to the backend servers.
                                   (default: 1000)
--debug                            Enables additional debug logging.
--help                             Dispalys this help text.

These options are the possible operations for proxysql-admin.
One of the options below must be provided.
--adduser                          Adds the Percona XtraDB Cluster application user to the ProxySQL database
--disable, -d                      Remove any Percona XtraDB Cluster configurations from ProxySQL
--enable, -e                       Auto-configure Percona XtraDB Cluster nodes into ProxySQL
--quick-demo                       Setup a quick demo with no authentication
--syncusers                        Sync user accounts currently configured in MySQL to ProxySQL
                                   May be used with --enable.
                                   (deletes ProxySQL users not in MySQL)
--sync-multi-cluster-users         Sync user accounts currently configured in MySQL to ProxySQL
                                   May be used with --enable.
                                   (doesn&#39;t delete ProxySQL users not in MySQL)
--version, -v                      Print version info
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>Before using the <code>proxysql-admin</code> tool, ensure that ProxySQL and
   Percona XtraDB Cluster nodes you want to add are running. For security purposes, please ensure to change the default user settings in the ProxySQL
   configuration file.</p>
<h2 id="preparing-configuration-file">Preparing Configuration File<a class="headerlink" href="#preparing-configuration-file" title="Permanent link">&para;</a></h2>
<p>It is recommended to provide connection and authentication information
in the ProxySQL configuration file (<code>/etc/proxysql-admin.cnf</code>),
instead of specifying it on the command line.</p>
<p>By default, the configuration file contains the following:</p>
<div class="highlight"><pre><span></span><code># proxysql admin interface credentials.
export PROXYSQL_DATADIR=&#39;/var/lib/proxysql&#39;
export PROXYSQL_USERNAME=&#39;admin&#39;
export PROXYSQL_PASSWORD=&#39;admin&#39;
export PROXYSQL_HOSTNAME=&#39;localhost&#39;
export PROXYSQL_PORT=&#39;6032&#39;

# PXC admin credentials for connecting to pxc-cluster-node.
export CLUSTER_USERNAME=&#39;admin&#39;
export CLUSTER_PASSWORD=&#39;admin&#39;
export CLUSTER_HOSTNAME=&#39;localhost&#39;
export CLUSTER_PORT=&#39;3306&#39;

# proxysql monitoring user. proxysql admin script will create this user in pxc to monitor pxc-nodes.
export MONITOR_USERNAME=&#39;monitor&#39;
export MONITOR_PASSWORD=&#39;monit0r&#39;

# Application user to connect to pxc-node through proxysql
export CLUSTER_APP_USERNAME=&#39;proxysql_user&#39;
export CLUSTER_APP_PASSWORD=&#39;passw0rd&#39;

# ProxySQL read/write hostgroup
export WRITE_HOSTGROUP_ID=&#39;10&#39;
export READ_HOSTGROUP_ID=&#39;11&#39;

# ProxySQL read/write configuration mode.
export MODE=&quot;singlewrite&quot;

# Writer-is-reader configuration
export WRITER_IS_READER=&quot;ondemand&quot;

# max_connections default (used only when INSERTing a new mysql_servers entry)
export MAX_CONNECTIONS=&quot;1000&quot;
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>It is recommended to change default ProxySQL credentials
   before running ProxySQL in production.
   Make sure that you provide ProxySQL location and credentials
   in the configuration file.</p>
<p>Provide superuser credentials for one of the Percona XtraDB Cluster nodes.
   The <code>proxysql-admin</code> script will detect
   other nodes in the cluster automatically.</p>
<h2 id="enabling-proxysql">Enabling ProxySQL<a class="headerlink" href="#enabling-proxysql" title="Permanent link">&para;</a></h2>
<p>Use the <code>--enable</code> option to automatically configure a Percona XtraDB Cluster node
into ProxySQL.
The <code>proxysql-admin</code> tool will do the following:</p>
<ul>
<li>
<p>Add Percona XtraDB Cluster node into the ProxySQL database</p>
</li>
<li>
<p>Add the <code>proxysql_galera_checker</code> monitoring script into the ProxySQL <code>scheduler</code> table if it is not available. This script checks for desynced nodes and temporarily deactivates them. It also calls the <code>proxysql_node_monitor</code> script, which checks cluster node membership and re-configures ProxySQL if the membership changes.</p>
</li>
<li>
<p>Create two new Percona XtraDB Cluster users with the <code>USAGE</code> privilege on the node and add them to ProxySQL configuration, if they are not already configured. ProxySQL uses one user for monitoring cluster nodes, and the other one is used for communicating with the cluster. Make sure to use super user credentials from Cluster to setup the default users.</p>
</li>
</ul>
<p>!!! warning</p>
<div class="highlight"><pre><span></span><code>  Running more then one copy of `proxysql_galera_check` in the same runtime
  environment simultaneously is not supported and may lead to undefined
  behavior.

  To avoid this problem, Galera process identification prevents a duplicate
  script execution in most cases. However, in some rare cases, it may be
  possible to circumvent this check if you run more then one copy of
  `proxysql_galera_check`.
</code></pre></div>
<p>The following example shows how to add a Percona XtraDB Cluster node
  using the ProxySQL configuration file
  with all necessary connection and authentication information:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>proxysql-admin<span class="w"> </span>--config-file<span class="o">=</span>/etc/proxysql-admin.cnf<span class="w"> </span>--enable
</code></pre></div>
<p><strong>The output</strong></p>
<div class="highlight"><pre><span></span><code>This script will assist with configuring ProxySQL for use with
Percona XtraDB Cluster (currently only PXC in combination with ProxySQL is supported)

ProxySQL read/write configuration mode is singlewrite

Configuring the ProxySQL monitoring user.  ProxySQL monitor user name as per
command line/config-file is monitor

User &#39;monitor&#39;@&#39;127.%&#39; has been added with USAGE privileges

Configuring the Percona XtraDB Cluster application user to connect through ProxySQL
Percona XtraDB Cluster application user name as per command line/config-file is proxysql_user

Percona XtraDB Cluster application user &#39;proxysql_user&#39;@&#39;127.%&#39; has been added with ALL privileges, this user is created for testing purposes
Adding the Percona XtraDB Cluster server nodes to ProxySQL

Write node info

+-----------+--------------+-------+--------+
| hostname  | hostgroup_id | port  | weight |
+-----------+--------------+-------+--------+
| 127.0.0.1 | 10           | 26100 | 1000   |
+-----------+--------------+-------+--------+

ProxySQL configuration completed!

ProxySQL has been successfully configured to use with Percona XtraDB Cluster

You can use the following login credentials to connect your application through ProxySQL

$ mysql --user=proxysql_user -p --host=localhost --port=6033 --protocol=tcp
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">hostgroup_id</span><span class="p">,</span><span class="n">hostname</span><span class="p">,</span><span class="n">port</span><span class="p">,</span><span class="n">status</span><span class="p">,</span><span class="k">comment</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">mysql_servers</span><span class="p">;</span>
</code></pre></div>
<p><strong>The output</strong></p>
<div class="highlight"><pre><span></span><code>      +--------------+-----------+-------+--------+---------+
      | hostgroup_id | hostname  | port  | status | comment |
      +--------------+-----------+-------+--------+---------+
      | 11           | 127.0.0.1 | 25400 | ONLINE | READ    |
      | 10           | 127.0.0.1 | 25000 | ONLINE | WRITE   |
      | 11           | 127.0.0.1 | 25100 | ONLINE | READ    |
      | 11           | 127.0.0.1 | 25200 | ONLINE | READ    |
      | 11           | 127.0.0.1 | 25300 | ONLINE | READ    |
      +--------------+-----------+-------+--------+---------+
      5 rows in set (0.00 sec)
</code></pre></div>
<h2 id="disabling-proxysql">Disabling ProxySQL<a class="headerlink" href="#disabling-proxysql" title="Permanent link">&para;</a></h2>
<p>Use the <code>--disable</code> option to remove a Percona XtraDB Cluster nodes configuration
from ProxySQL.
The <code>proxysql-admin</code> tool will do the following:</p>
<ul>
<li>
<p>Remove Percona XtraDB Cluster node from the ProxySQL database</p>
</li>
<li>
<p>Stop the ProxySQL monitoring daemon for this node</p>
</li>
<li>
<p>Remove the application user for this cluster</p>
</li>
<li>
<p>Remove any query rules set up for this cluster</p>
</li>
</ul>
<p>The following example shows how to disable ProxySQL
  and remove the Percona XtraDB Cluster node:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>proxysql-admin<span class="w"> </span>--config-file<span class="o">=</span>/etc/proxysql-admin.cnf<span class="w"> </span>--disable
</code></pre></div>
<p>The examle of the output:</p>
<div class="highlight"><pre><span></span><code>ProxySQL configuration removed!
</code></pre></div>
<h2 id="additional-options">Additional Options<a class="headerlink" href="#additional-options" title="Permanent link">&para;</a></h2>
<p>The following extra options can be used:</p>
<ul>
<li><code>--adduser</code></li>
</ul>
<p>Add Percona XtraDB Cluster application user to ProxySQL database.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>proxysql-admin<span class="w"> </span>--config-file<span class="o">=</span>/etc/proxysql-admin.cnf<span class="w"> </span>--adduser
</code></pre></div>
<p>The examle of the output:</p>
<div class="highlight"><pre><span></span><code>Adding Percona XtraDB Cluster application user to ProxySQL database
Enter Percona XtraDB Cluster application user name: cluster_user
Enter Percona XtraDB Cluster application user password: cluster_passw0Rd
Added Percona XtraDB Cluster application user to ProxySQL database!
</code></pre></div>
<ul>
<li><code>--syncusers</code></li>
</ul>
<p>Sync user accounts currently configured in Percona XtraDB Cluster to ProxySQL database
  except users with no password and the <code>admin</code> user.</p>
<p>!!! note</p>
<div class="highlight"><pre><span></span><code>  This option also deletes users
  that are not in Percona XtraDB Cluster from ProxySQL database.
</code></pre></div>
<ul>
<li><code>--sync-multi-cluster-users</code></li>
</ul>
<p>This option works in the same way as syncusers but it does not delete ProxySQL
  users that are not present in the Percona XtraDB Cluster. It is to be used when
  syncing proxysql instances that manage multiple clusters.</p>
<ul>
<li><code>--node-check-interval</code></li>
</ul>
<p>This option configures the interval for monitoring via the
  <code>proxysql_galera_checker</code> script (in milliseconds).</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>proxysql-admin<span class="w"> </span>--config-file<span class="o">=</span>/etc/proxysql-admin.cnf<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--node-check-interval<span class="o">=</span><span class="m">5000</span><span class="w"> </span>--enable
</code></pre></div>
<ul>
<li><code>--mode</code></li>
</ul>
<p>Set the read/write mode for Percona XtraDB Cluster nodes in ProxySQL database,
  based on the hostgroup.
  Supported modes are <code>loadbal</code> and <code>singlewrite</code>.</p>
<div class="highlight"><pre><span></span><code>* `singlewrite` is the default mode,
  it will accept writes only on one single node
  (based on the info you provide in `--write-node`).
  Remaining nodes will accept only read statements.

  Servers can be separated by commas, for example:

  ```text
  10.0.0.51:3306,10.0.0.52:3306
  ```

  In the previous example, `10.0.0.51:3306` will be in the writer hostgroup
  if it is ONLINE.
  If it is OFFLINE, then `10.0.0.52:3306` will go into the writer hostgroup.
  And if that node also goes down, then one of the remaining nodes
  will be randomly chosen for the writer hostgroup.
  The configuration file is deleted when `--disable` is used.

* `singlewrite` mode setup:

  ```text
  $ sudo grep &quot;MODE&quot; /etc/proxysql-admin.cnf
  export MODE=&quot;singlewrite&quot;
  $ sudo proxysql-admin --config-file=/etc/proxysql-admin.cnf --write-node=127.0.0.1:25000 --enable
  ProxySQL read/write configuration mode is singlewrite
  [..]
  ProxySQL configuration completed!
  ```

  To check the configuration you can run:

  ```sql
  mysql&gt; SELECT hostgroup_id,hostname,port,status,comment FROM mysql_servers;
  ```

  The example of the output is the following:

  ```text
  +--------------+-----------+-------+--------+---------+
  | hostgroup_id | hostname  | port  | status | comment |
  +--------------+-----------+-------+--------+---------+
  | 11           | 127.0.0.1 | 25400 | ONLINE | READ    |
  | 10           | 127.0.0.1 | 25000 | ONLINE | WRITE   |
  | 11           | 127.0.0.1 | 25100 | ONLINE | READ    |
  | 11           | 127.0.0.1 | 25200 | ONLINE | READ    |
  | 11           | 127.0.0.1 | 25300 | ONLINE | READ    |
  +--------------+-----------+-------+--------+---------+
  5 rows in set (0.00 sec)
  ```

* The `loadbal` mode uses a set of evenly weighted read/write nodes.

  `loadbal` mode setup:

  ```text
  $ sudo proxysql-admin --config-file=/etc/proxysql-admin.cnf --mode=loadbal --enable

  This script will assist with configuring ProxySQL (currently only Percona XtraDB cluster in combination with ProxySQL is supported)

  ProxySQL read/write configuration mode is loadbal
  [..]
  ProxySQL has been successfully configured to use with Percona XtraDB Cluster

  You can use the following login credentials to connect your application through ProxySQL

  mysql --user=proxysql_user --password=*****  --host=127.0.0.1 --port=6033 --protocol=tcp
  ```

  To check the configuration you can run:

  ```sql
  mysql&gt; SELECT hostgroup_id,hostname,port,status,comment FROM mysql_servers;
  ```

  The example of the output is the following:

  ```text
  +--------------+-----------+-------+--------+-----------+
  | hostgroup_id | hostname  | port  | status | comment   |
  +--------------+-----------+-------+--------+-----------+
  | 10           | 127.0.0.1 | 25400 | ONLINE | READWRITE |
  | 10           | 127.0.0.1 | 25000 | ONLINE | READWRITE |
  | 10           | 127.0.0.1 | 25100 | ONLINE | READWRITE |
  | 10           | 127.0.0.1 | 25200 | ONLINE | READWRITE |
  | 10           | 127.0.0.1 | 25300 | ONLINE | READWRITE |
  +--------------+-----------+-------+--------+-----------+
  5 rows in set (0.01 sec)
  ```
</code></pre></div>
<ul>
<li><code>--quick-demo</code></li>
</ul>
<p>This option is used to setup dummy ProxySQL configuration.</p>
<div class="highlight"><pre><span></span><code>$ sudo  proxysql-admin  --enable --quick-demo

You have selected the dry test run mode. WARNING: This will create a test user (with all privileges) in the Percona XtraDB Cluster &amp; ProxySQL installations.

You may want to delete this user after you complete your testing!

Would you like to proceed with &#39;--quick-demo&#39; [y/n] ? y

Setting up proxysql test configuration!

Do you want to use the default ProxySQL credentials (admin:admin:6032:127.0.0.1) [y/n] ? y
Do you want to use the default Percona XtraDB Cluster credentials (root::3306:127.0.0.1) [y/n] ? n

Enter the Percona XtraDB Cluster username (super user): root
Enter the Percona XtraDB Cluster user password:
Enter the Percona XtraDB Cluster port: 25100
Enter the Percona XtraDB Cluster hostname: localhost

ProxySQL read/write configuration mode is singlewrite

Configuring ProxySQL monitoring user..

User &#39;monitor&#39;@&#39;127.%&#39; has been added with USAGE privilege

Configuring the Percona XtraDB Cluster application user to connect through ProxySQL

Percona XtraDB Cluster application user &#39;pxc_test_user&#39;@&#39;127.%&#39; has been added with ALL privileges, this user is created for testing purposes

Adding the Percona XtraDB Cluster server nodes to ProxySQL

ProxySQL configuration completed!

ProxySQL has been successfully configured to use with Percona XtraDB Cluster

You can use the following login credentials to connect your application through ProxySQL

mysql --user=pxc_test_user  --host=127.0.0.1 --port=6033 --protocol=tcp
</code></pre></div>
<ul>
<li><code>--include-slaves=host_name:port</code></li>
</ul>
<p>This option helps to include specified replica node(s) to ProxySQL database.
  These nodes will go into the reader hostgroup and will only be put into the
  writer hostgroup if all cluster nodes are down. Replicas must be read only. Can
  accept comma delimited list. If this is used, make sure <code>read_only=1</code> is
  included into the replicas <code>my.cnf</code> configuration file.</p>
<p>!!! note</p>
<div class="highlight"><pre><span></span><code>  With `loadbal` mode replica hosts only accept read/write requests
  when all cluster nodes are down.
</code></pre></div>
<h2 id="proxysql-status-script">ProxySQL Status script<a class="headerlink" href="#proxysql-status-script" title="Permanent link">&para;</a></h2>
<p>There is a simple script to dump ProxySQL configuration and statistics:</p>
<div class="highlight"><pre><span></span><code>Usage:

proxysql-status admin admin 127.0.0.1 6032
</code></pre></div>

                
<div class="md-relbar2__inner md-grid">
<div class="md-content">
  <article class="md-content__inner md-typeset" role="main">    
    <h3>Contact us </h3>
    <p>For free technical help, visit the Percona <a class="reference external" href="https://forums.percona.com/c/mysql-mariadb/percona-xtradb-cluster-5-x/12" target="_blank">Community Forum</a>.<br>
      <p>To report bugs or submit feature requests, open a <a class="reference external" href="https://jira.percona.com/projects/PXC/issues" target="_blank">JIRA</a> ticket.<br>
       <p>For paid <a class="reference external" href="https://www.percona.com/services/support"> support </a> and <a class="reference external" href="https://www.percona.com/services/managed-services"> managed </a> or <a class="reference external" href="https://www.percona.com/services/consulting">consulting services </a>, contact <a class="reference external" href="https://www.percona.com/about-percona/contact" target="_blank">Percona Sales</a>.</p>
 </article>
</div>
</div>

                <!-- Last update of source file -->
                
                  
                    <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2022-08-23
    
  </small>
</div>
                  
                
              
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    <div class="md-copyright__highlight">
 <a href='https://percona.com' target='_blank'>Percona LLC and/or its affiliates, </a> &copy; 2023
    </div>
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "navigation.top", "content.tabs.link", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
              
      <script src="../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../js/version-select.js"></script>
      
        <script src="../js/promptremover.js"></script>
      
    

              <img src="https://tracking.g2crowd.com/attribution_tracking/conversions/1007137.gif?e=" width="1" height="1" />

              <noscript>
                <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K48FGP2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
              </noscript>
              
  </body>
</html>